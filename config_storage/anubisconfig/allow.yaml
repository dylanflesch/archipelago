# Put here your Own Public and Private IPs. Even the Docker ones if you want so
#- name: allow-my-archipelago-ips
#  action: ALLOW
#  remote_addresses: [
#  ]
- name: allow-my-archipelago-webannon-api-routes
  action: ALLOW
  expression:
    all:
    - '!(method == "HEAD")'
    - path.startsWith("/do/")
    - path.contains("/webannon/")
- name: allow-my-archipelago-webform-routes
  action: ALLOW
  expression:
    all:
    - path.startsWith("/webform_strawberry")
- name: allow-my-archipelago-search-api-routes
  action: ALLOW
  expression:
    all:
    - path.startsWith("/do/")
    - path.contains("/metadata/search")
- name: allow-my-archipelago-jsonapi
  action: ALLOW
  expression:
    all:
    - path.startsWith("/jsonapi/")
- name: allow-my-archipelago-ajax
  action: ALLOW
  expression:
    all:
    - >-
        (  
          path.startsWith("/ajax") ||
          path.contains("/metadata/") ||
          path.contains("/flavorsearch/") ||
          path.contains("/exposed-views-form-block-ajax") ||
          path.startsWith("/views/ajax") ||
          path.startsWith("/views-bulk-operations") ||
          path.startsWith("/batch")
        )
    - '"Sec-Fetch-Dest" in headers'
    - 'headers["Sec-Fetch-Dest"] == "empty"'
